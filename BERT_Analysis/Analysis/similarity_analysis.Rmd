---
title: "Untitled"
author: "Joanna Schroeder"
date: "4/10/2023"
output: html_document
---

```{r fig.height = 20}
library(tidyverse)
library(lsa)

#list.files("~/git/dspg22ari2/BERT_Analysis/Docs")

matrix <- read.csv("output_vectors.csv")

cosine <- cosine(t(matrix)) %>% as.data.frame() %>% rownames_to_column() %>% pivot_longer(!rowname) %>%
  select(doc_one = rowname, doc_two = name, cosine_similarity = value) %>% 
  mutate(doc_two = sub("V", "", doc_two))

cosine %>%
  ggplot(aes(x = reorder(doc_one, as.numeric(doc_one)), 
             y = reorder(doc_two, as.numeric(doc_two)),
             fill = cosine_similarity)) + 
    geom_tile() +    
    #geom_text(aes(label = round(cosine_similarity, 3)), size = 6) +  
    scale_x_discrete(position = "top") + 
    scale_y_discrete(limits = rev) +
    scale_fill_gradient(low = "white", high = "#E57200") +
    theme(legend.position="bottom", panel.background = element_blank(),         
          plot.title = element_text(face = "bold"), text = element_text(size = 23),
          legend.key.width = unit(4,"line")) +  
    labs(fill = "Cosine Similarity",     
         y = "Document Y",       
         x = "Document X") +
    guides(fill = guide_colorbar(title.position = "top"))

cosine %>% filter(doc_one == 1) %>%
  ggplot(aes(x = factor(doc_one), y = reorder(factor(doc_two), -cosine_similarity), fill = cosine_similarity)) + 
    geom_tile() +    
    geom_text(aes(label = round(cosine_similarity, 3)), size = 6) +  
    scale_x_discrete(position = "top") + 
    scale_y_discrete(limits = rev) +
    scale_fill_gradient(low = "white", high = "#E57200") +
    theme(legend.position="bottom", panel.background = element_blank(),         
          plot.title = element_text(face = "bold"), text = element_text(size = 23),
          legend.key.width = unit(4,"line")) +  
    labs(fill = "Cosine Similarity",     
         y = "Document Y",       
         x = "Document X") +
    guides(fill = guide_colorbar(title.position = "top"))
```

